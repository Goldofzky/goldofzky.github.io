---
layout: post
title:  "类文件结构与虚拟机类加载机制"
subtitle: "JVM笔记3"
header-img: "img/post-bg-universe.jpg"
tag: 
    - JVM笔记
---
**目录**
* content
{:toc}

# 平台无关性
* `平台无关性`是JVM所具有的另一重要特性。这些虚拟机可以载入和执行同一种平台无关的字节码，从而实现了程序的“一次编写，到处运行”。  
* 各种平台的虚拟机与所有平台都同一使用的程序存储格式--字节码是构成平台无关性的基石。
* **Java虚拟机不和包括Java在内的任何语言绑定**，它只与“Class 文件”这种特定的二进制文件格式所关联，Class文件中包含了Java虚拟机指令集和符号表以及若干其他辅助信息。

# Class类文件的结构
* Class文件时一组以8位字节为基础单位的二进制流，各个数据严格按照顺序紧凑地排列在Class文件之中，中间没有添加任何分隔符，这使得整个Class文件中存储地内容几乎全是程序运行地必要数据，没有空隙存在。  
* Class文件格式采用一种类似于C语言结构体地伪结构来存储数据，这种伪结构只有两种数据类型：`无符号数`和`表`。  
**无符号数**：属于基本的数据类型，以u1、u2、u4、u8来分别代表1个字节、2个字节、3个字节、4个字节和8个字节的无符号数，无符号数可以用来描述数字、索引引用、数量值或者按照UTF-8编码构成字符串值。  
**表**：表是由多个无符号数或者其他表作为数据项构成的复合数据类型，所有表都习惯性地以“_info”结尾。表用于描述有层次关系地复合结构地数据，整个Class文件本质上就是一张表。  
![](\img\in-post\L-JVM\JVM3-1.PNG)  

## 魔数与Class文件的版本
* 每个Class文件的头4个字节称为`魔数`（Magic Number），它的唯一作用是确定这个文件是否为一个能被虚拟机接受的Class文件。
* 很多文件存储标准中都使用魔数来进行身份识别,Class的魔数值为：`0xCAFEBABE`。
* 第5和第6字节是次版本号（Minor Version），第7和第8字节是主版本号（Major Version）。版本向下兼容。

## 常量池
* 常量池在主次版本号之后，可以理解为Class文件之中的资源仓库。


*** 
**填坑中...**

