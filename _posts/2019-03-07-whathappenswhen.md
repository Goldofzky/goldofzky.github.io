---
layout: post
title:  "发生了什么？"
subtitle: "当你再浏览器输入URL，敲击回车之后"
header-img: "img/about-bg-walle.jpg"
tag: 
    - 网络原理
---

# 解析URL
* 浏览器通过URL能够知道以下信息:
  * 协议的类型:"http"   
  使用HTTP协议
  * 请求的资源

# DNS查询
* 检查域名是否再`浏览器的缓存`中
  * 若有，则直接获得IP地址
* 若没有命中
  * 进行`ARP广播`查询DNS服务器
    * 如果DNS服务器和我们的主机在同一个子网内,则使用和那个子网相连的接口
    * 否则只有默认网关相连的接口
* 找到DNS服务器，此时用的是udp协议，DNS查询到域名对应的IP后，将IP返回给浏览器
* 浏览器对IP进行本地缓存

# 使用套接字
* 浏览器得到了目标服务器的IP地址，以及URL种给出来的端口号(http默认80，https默认443),它会调用系统库函数socket，  
请求一个`TCP流套接字`
* TCP进行封包
* 若是http，则会通过http协议进行通信
* 若是https，会在http协议的基础上，会多出`TLS握手过程`(CA证书认证，公钥加密对称密钥，服务器私钥解密，通过对称密钥通信)
* 三次握手建立连接
* 若要结束连接，则进行四次挥手

# 浏览器
当服务器提供了资源之后（HTML，CSS，JS，图片等），浏览器会执行下面的操作：  
* 解析 —— HTML，CSS，JS
* 渲染 —— 构建 DOM 树 -> 渲染 -> 布局 -> 绘制

# 如果url为localhost
> 需要注意的是我们经常将localhost和127.0.0.1划为等号,但是两者并不相同
  
* localhost不经过网卡传输(不受防火墙限制)，127.0.0.1经过网卡传输
* localhost不会被解析成ip，而用127.0.0.1的时候，等于本机是通过网络再去访问本机，用的到网络用户的权限
* 一般情况下localhost更快，它依赖的是unix套接字，`没有TCP`的过程